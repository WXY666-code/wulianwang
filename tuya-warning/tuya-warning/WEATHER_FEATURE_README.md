# 天气信息功能说明

## 功能概述

天气信息功能是为智能聊天机器人新增的实用功能，可以在不影响原有主要功能的前提下，为用户提供实时的天气信息。

## 主要特性

### 1. 自动天气更新
- 每小时自动从网络获取一次天气数据
- 支持温度、湿度、风速等详细信息
- 自动识别天气状况并显示相应图标

### 2. 语音查询天气
- 用户可以通过语音询问天气信息
- 支持关键词："天气"
- 示例：说"今天天气怎么样？"即可获得天气信息

### 3. 屏幕显示天气
- 在LCD屏幕上显示当前天气状态
- 显示天气图标和温度信息
- 每5分钟更新一次显示

### 4. 天气图标支持
- ☀️ 晴天
- ☁️ 多云
- 🌧️ 雨天
- ❄️ 雪天
- 🌫️ 雾天
- ⛈️ 雷雨
- 💨 大风

## 配置选项

### 启用/禁用天气功能
在 `tos menuconfig` 中可以配置：
```
configure app (your_chat_bot)  --->
    [*] enable weather information feature
```

### 默认城市设置
默认城市设置为北京，可以在 `src/app_weather.c` 中修改：
```c
#define DEFAULT_CITY "Beijing"
```

## 技术实现

### 文件结构
```
include/
  └── app_weather.h          # 天气模块头文件
src/
  └── app_weather.c          # 天气模块实现文件
```

### 主要函数
- `app_weather_init()` - 初始化天气模块
- `app_weather_update()` - 更新天气数据
- `app_weather_get_data()` - 获取天气数据
- `app_weather_handle_voice_query()` - 处理语音查询
- `app_weather_get_icon()` - 获取天气图标

### 数据源
当前版本使用模拟天气数据：
- 温度：25°C
- 湿度：65%
- 天气状况：Partly cloudy
- 风速：12 km/h

**注意**：由于涂鸦SDK的限制，当前版本使用模拟数据。后续版本将集成真实的天气API。

## 使用方法

### 1. 编译配置
```bash
# 选择开发板配置
tos config_choice

# 配置功能选项
tos menuconfig

# 编译项目
tos build
```

### 2. 语音查询
- 唤醒设备后说"天气"相关词汇
- 设备会返回当前天气信息
- 信息包含城市、天气状况、温度、湿度、风速

### 3. 屏幕查看
- 设备会自动在状态栏显示天气图标和温度
- 格式：`☀️ 25°C`

## 注意事项

1. **模拟数据**：当前版本使用模拟天气数据，无需网络连接
2. **数据固定**：模拟数据固定为25°C，65%湿度，多云天气
3. **城市设置**：目前使用默认城市，后续可扩展为可配置
4. **内存使用**：天气模块会占用少量内存用于数据缓存

## 扩展功能

未来可以考虑添加的功能：
1. **真实天气API集成**：集成真实的天气服务API
2. 多城市支持
3. 天气预报（未来几天）
4. 天气提醒（下雨提醒等）
5. 位置自动检测
6. 更多天气数据（气压、能见度等）

## 故障排除

### 常见问题
1. **天气数据获取失败**
   - 当前版本使用模拟数据，无需网络连接
   - 如果显示异常，检查设备初始化状态

2. **语音查询不响应**
   - 确认天气功能已启用
   - 检查语音识别关键词

3. **屏幕显示异常**
   - 确认显示功能已启用
   - 检查天气图标字符支持

### 调试信息
天气模块会输出调试信息：
```
Weather module initialized (mock data mode)
Mock weather updated: Beijing, 25°C, Partly cloudy
``` 